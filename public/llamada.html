<!DOCTYPE html>
<html>

<head>
	<title>Voku</title>

	<meta name="robots" content="noindex" />
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

	<!-- Browser icons -->
	<link rel="icon" sizes="192x192" href="favicon.png">
	<!-- <link rel="apple-touch-icon" href="ios-icon.png">
	<link rel="apple-touch-icon" href="touch-icon-iphone.png">
	<link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png">
	<link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png">
	<link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png"> -->

	<!-- Browser color -->
	<meta name="theme-color" content="#000000">

	<!-- Iphone startup image -->
	<!-- <link href="https://placehold.it/1242x2148" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
	 rel="apple-touch-startup-image">
	<link href="https://placehold.it/1182x2208" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
	 rel="apple-touch-startup-image">
	<link href="https://placehold.it/750x1294" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)"
	 rel="apple-touch-startup-image">
	<link href="https://placehold.it/640x1096" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)"
	 rel="apple-touch-startup-image">
	<link href="https://placehold.it/640x920" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)"
	 rel="apple-touch-startup-image">
	<link href="https://placehold.it/320x460" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)"
	 rel="apple-touch-startup-image"> -->

	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/solid.css" integrity="sha384-VGP9aw4WtGH/uPAOseYxZ+Vz/vaTb1ehm1bwx92Fm8dTrE+3boLfF1SpAtB1z7HW"
	 crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/fontawesome.css" integrity="sha384-1rquJLNOM3ijoueaaeS5m+McXPJCGdr5HcA03/VHXxcp2kX2sUrQDmFc3jR5i/C7"
	 crossorigin="anonymous">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<link rel="stylesheet" type="text/css" href="estilosMaqueta.css">

	<script src="/__/firebase/5.0.4/firebase-app.js"></script>
	<script src="/__/firebase/init.js"></script>
</head>

<body>
	<div class="w3-modal-content w3-animate-zoom w3-container w3-purple w3-center disclaimer anim-0 until-1">
		<div class="w3-section">
			<p>¡Bienvenido! Recuerda que necesitas subir el volumen de tu dispositivo antes de seguir.</p>
			<button class="w3-button w3-round w3-large w3-green" onclick="init()">¡ENTENDIDO!</button>
		</div>
	</div>

	<div class="gradient w3-animate-opacity anim-0 until-0">
		<div class="w3-center image-container">
			<img id="avatar-src" class="w3-circle w3-image imagen-de-llamada w3-animate-zoom anim-1" alt="Imagen de llamada entrante">
			<p class="w3-animate-fading w3-text-white w3-large texto-llamada anim-1 until-1">Frédéric Chopin está llamando...</p>
			<div class="w3-panel w3-gray w3-opacity w3-padding-large w3-xxxlarge anim-1 until-1" id="counter">00:00</div>
		</div>

		<div class="w3-animate-opacity">
			<button class="w3-display-bottomleft w3-button w3-circle w3-green botonLlamada" onclick="contestar(); this.disabled = true"><i class="fas fa-phone fa-3x"></i></button>
			<button class="w3-display-bottomright w3-button w3-circle w3-red botonLlamada" onclick="location.href = 'detalle.html'""><i class="
			 fas fa-phone fa-3x" style="transform: rotate(225deg)"></i></button>
		</div>
	</div>

	<!-- Oculto -->
	<div style="visibility: hidden; position: absolute;">
		<audio id="phone-ring">
			<source src="asset/audio/phone-ring.mp3" type="audio/mpeg">
		</audio>
		<audio id="feature-audio">
			<source id="feature-audio-src" type="audio/mpeg">
		</audio>
		<i class="fas fa-phone fa-3x"></i>
	</div>
</body>

<script>
	//Ejecuta al ingresar al sitio
	let callId = window.location.href.toLowerCase().split("callid=")
	if (!callId[1]) { window.location.href = "/" }
	document.getElementById("avatar-src").setAttribute("src", "asset/img/" + callId[1] + "/feature-img.jpeg");
	document.getElementById("feature-audio-src").setAttribute("src", "asset/audio/" + callId[1] + "/feature-audio.mp3");

	function init() {
		let audio = document.getElementById("phone-ring");
		audio.addEventListener('ended', function () {
			this.currentTime = 0;
			this.play();
		}, false);
		audio.play();

		avanzarAnimacion(0);
	}

	function contestar() {
		document.getElementById('phone-ring').pause()
		document.getElementById('feature-audio').play()
		avanzarAnimacion(1);

		let tiempo = 0;
		let contador = document.getElementById("counter");
		setInterval(() => { contador.innerHTML = obtenerString(tiempo); tiempo++ }, 1000)
	}

	// Utilities
	function avanzarAnimacion(keyframe) {
		let animCol = document.getElementsByClassName("anim-" + keyframe);
		for (let index = 0; index < animCol.length;) {
			const element = animCol[index];
			element.classList.remove("anim-" + keyframe);
			if (element.classList.contains("until-" + keyframe)) { element.classList.add("anim-fin"); }
			else { element.classList.add("anim-" + (keyframe + 1)); }
		}
	}

	function obtenerString(number) {
		let minutos = Math.floor(number / 60);
		let segundos = number - (minutos * 60);
		return minutos.toString().padStart(2, "0") + ":" + segundos.toString().padStart(2, "0")
	}
</script>

</html>